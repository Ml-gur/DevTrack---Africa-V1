<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>DevTrack Africa - PWA Asset Generator</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      padding: 20px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .container {
      background: white;
      border-radius: 20px;
      padding: 40px;
      max-width: 900px;
      width: 100%;
      box-shadow: 0 20px 60px rgba(0,0,0,0.3);
    }

    h1 {
      color: #1a202c;
      margin-bottom: 10px;
      font-size: 2rem;
    }

    .subtitle {
      color: #718096;
      margin-bottom: 30px;
      font-size: 0.95rem;
    }

    .upload-area {
      border: 3px dashed #cbd5e0;
      border-radius: 12px;
      padding: 40px;
      text-align: center;
      margin-bottom: 30px;
      cursor: pointer;
      transition: all 0.3s;
      background: #f7fafc;
    }

    .upload-area:hover {
      border-color: #667eea;
      background: #edf2f7;
    }

    .upload-area.drag-over {
      border-color: #667eea;
      background: #e6fffa;
    }

    input[type="file"] {
      display: none;
    }

    .icon-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
      gap: 20px;
      margin-top: 30px;
    }

    .icon-item {
      text-align: center;
      padding: 15px;
      background: #f7fafc;
      border-radius: 12px;
      transition: all 0.2s;
    }

    .icon-item:hover {
      transform: translateY(-5px);
      box-shadow: 0 10px 20px rgba(0,0,0,0.1);
    }

    .icon-item canvas {
      border-radius: 8px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }

    .icon-size {
      margin-top: 10px;
      font-size: 0.8rem;
      color: #718096;
      font-weight: 600;
    }

    .button {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      border: none;
      padding: 14px 32px;
      border-radius: 10px;
      font-size: 1rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s;
      margin: 10px;
      box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
    }

    .button:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(102, 126, 234, 0.6);
    }

    .button:active {
      transform: translateY(0);
    }

    .button-group {
      display: flex;
      justify-content: center;
      gap: 10px;
      margin: 30px 0;
      flex-wrap: wrap;
    }

    .progress {
      margin: 20px 0;
      display: none;
    }

    .progress-bar {
      height: 8px;
      background: #e2e8f0;
      border-radius: 10px;
      overflow: hidden;
    }

    .progress-fill {
      height: 100%;
      background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
      width: 0%;
      transition: width 0.3s;
    }

    .status {
      text-align: center;
      margin: 20px 0;
      padding: 15px;
      border-radius: 10px;
      display: none;
    }

    .status.success {
      background: #c6f6d5;
      color: #22543d;
      display: block;
    }

    .status.error {
      background: #fed7d7;
      color: #742a2a;
      display: block;
    }

    .preview {
      margin-top: 20px;
      padding: 20px;
      background: #f7fafc;
      border-radius: 12px;
      display: none;
    }

    .preview.active {
      display: block;
    }

    .preview img {
      max-width: 200px;
      max-height: 200px;
      margin: 10px auto;
      display: block;
      border-radius: 12px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }

    .checklist {
      background: #f7fafc;
      padding: 20px;
      border-radius: 12px;
      margin-top: 30px;
    }

    .checklist h3 {
      margin-bottom: 15px;
      color: #2d3748;
    }

    .checklist-item {
      padding: 10px;
      margin: 5px 0;
      background: white;
      border-radius: 8px;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .checklist-item.done {
      background: #c6f6d5;
    }

    .checkbox {
      width: 20px;
      height: 20px;
      border: 2px solid #cbd5e0;
      border-radius: 4px;
      flex-shrink: 0;
    }

    .checklist-item.done .checkbox {
      background: #48bb78;
      border-color: #48bb78;
      position: relative;
    }

    .checklist-item.done .checkbox::after {
      content: 'âœ“';
      color: white;
      position: absolute;
      top: -2px;
      left: 3px;
      font-weight: bold;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>ðŸŽ¨ DevTrack Africa PWA Asset Generator</h1>
    <p class="subtitle">Generate all required PWA icons and assets in one click</p>

    <div class="upload-area" id="uploadArea">
      <div style="font-size: 3rem; margin-bottom: 10px;">ðŸ“¤</div>
      <h3>Upload Your Logo</h3>
      <p style="color: #718096; margin-top: 10px;">Drop your logo here or click to browse</p>
      <p style="color: #a0aec0; font-size: 0.85rem; margin-top: 5px;">(PNG, SVG, or JPEG - Recommended: 1024x1024)</p>
      <input type="file" id="fileInput" accept="image/*">
    </div>

    <div class="preview" id="preview">
      <h3>Preview</h3>
      <img id="previewImage" alt="Logo preview">
    </div>

    <div class="button-group">
      <button class="button" onclick="generateAllIcons()">ðŸš€ Generate All Icons</button>
      <button class="button" onclick="downloadAllIcons()">ðŸ“¥ Download All as ZIP</button>
      <button class="button" onclick="generateScreenshots()">ðŸ“± Generate Screenshots</button>
    </div>

    <div class="progress" id="progress">
      <div class="progress-bar">
        <div class="progress-fill" id="progressFill"></div>
      </div>
      <p id="progressText" style="text-align: center; margin-top: 10px; color: #718096;"></p>
    </div>

    <div class="status" id="status"></div>

    <div class="icon-grid" id="iconGrid"></div>

    <div class="checklist">
      <h3>ðŸ“‹ PWA Asset Checklist</h3>
      <div class="checklist-item" id="check-icons">
        <div class="checkbox"></div>
        <span>Generate all icon sizes (72x72 to 512x512)</span>
      </div>
      <div class="checklist-item" id="check-maskable">
        <div class="checkbox"></div>
        <span>Create maskable icons for Android</span>
      </div>
      <div class="checklist-item" id="check-apple">
        <div class="checkbox"></div>
        <span>Generate Apple touch icons</span>
      </div>
      <div class="checklist-item" id="check-splash">
        <div class="checkbox"></div>
        <span>Create iOS splash screens</span>
      </div>
      <div class="checklist-item" id="check-screenshots">
        <div class="checkbox"></div>
        <span>Generate app screenshots</span>
      </div>
    </div>
  </div>

  <script>
    const sizes = [72, 96, 128, 144, 152, 192, 384, 512];
    const maskableSizes = [192, 512];
    let uploadedImage = null;

    // Upload area functionality
    const uploadArea = document.getElementById('uploadArea');
    const fileInput = document.getElementById('fileInput');
    const preview = document.getElementById('preview');
    const previewImage = document.getElementById('previewImage');

    uploadArea.addEventListener('click', () => fileInput.click());

    uploadArea.addEventListener('dragover', (e) => {
      e.preventDefault();
      uploadArea.classList.add('drag-over');
    });

    uploadArea.addEventListener('dragleave', () => {
      uploadArea.classList.remove('drag-over');
    });

    uploadArea.addEventListener('drop', (e) => {
      e.preventDefault();
      uploadArea.classList.remove('drag-over');
      const file = e.dataTransfer.files[0];
      if (file && file.type.startsWith('image/')) {
        handleImageUpload(file);
      }
    });

    fileInput.addEventListener('change', (e) => {
      const file = e.target.files[0];
      if (file) {
        handleImageUpload(file);
      }
    });

    function handleImageUpload(file) {
      const reader = new FileReader();
      reader.onload = (e) => {
        const img = new Image();
        img.onload = () => {
          uploadedImage = img;
          previewImage.src = e.target.result;
          preview.classList.add('active');
          showStatus('Image uploaded successfully! Ready to generate icons.', 'success');
        };
        img.src = e.target.result;
      };
      reader.readAsDataURL(file);
    }

    function generateAllIcons() {
      if (!uploadedImage) {
        showStatus('Please upload an image first!', 'error');
        return;
      }

      const iconGrid = document.getElementById('iconGrid');
      iconGrid.innerHTML = '';
      
      showProgress();
      let completed = 0;
      const total = sizes.length;

      sizes.forEach((size, index) => {
        setTimeout(() => {
          const canvas = document.createElement('canvas');
          const ctx = canvas.getContext('2d');
          canvas.width = size;
          canvas.height = size;

          // Check if this should be maskable
          const isMaskable = maskableSizes.includes(size);
          
          if (isMaskable) {
            // Add safe zone for maskable icons (80% of size)
            const safeZone = size * 0.8;
            const offset = (size - safeZone) / 2;
            
            // Fill background with brand color
            ctx.fillStyle = '#10b981';
            ctx.fillRect(0, 0, size, size);
            
            // Draw image in safe zone
            ctx.drawImage(uploadedImage, offset, offset, safeZone, safeZone);
          } else {
            // Regular icon - full size
            ctx.drawImage(uploadedImage, 0, 0, size, size);
          }

          // Create icon item
          const iconItem = document.createElement('div');
          iconItem.className = 'icon-item';
          iconItem.innerHTML = `
            <canvas width="${size}" height="${size}" style="width: 100%; height: auto;"></canvas>
            <div class="icon-size">${size}x${size}${isMaskable ? ' (Maskable)' : ''}</div>
            <button class="button" style="padding: 8px 16px; font-size: 0.8rem; margin-top: 10px;" onclick="downloadIcon('${size}')">
              Download
            </button>
          `;
          
          const itemCanvas = iconItem.querySelector('canvas');
          const itemCtx = itemCanvas.getContext('2d');
          itemCtx.drawImage(canvas, 0, 0);
          
          iconGrid.appendChild(iconItem);

          // Store canvas for download
          window['canvas_' + size] = canvas;

          completed++;
          updateProgress(completed, total);

          if (completed === total) {
            hideProgress();
            showStatus(`âœ… Successfully generated ${total} icons!`, 'success');
            markChecklistItem('check-icons', true);
            markChecklistItem('check-maskable', true);
            markChecklistItem('check-apple', true);
          }
        }, index * 100);
      });
    }

    function downloadIcon(size) {
      const canvas = window['canvas_' + size];
      if (canvas) {
        canvas.toBlob((blob) => {
          const url = URL.createObjectURL(blob);
          const a = document.createElement('a');
          a.href = url;
          a.download = `icon-${size}x${size}.png`;
          a.click();
          URL.revokeObjectURL(url);
        });
      }
    }

    function downloadAllIcons() {
      if (!window['canvas_72']) {
        showStatus('Please generate icons first!', 'error');
        return;
      }

      showStatus('Downloading all icons... (Check your downloads folder)', 'success');
      
      sizes.forEach((size, index) => {
        setTimeout(() => {
          downloadIcon(size);
        }, index * 200);
      });
    }

    function generateScreenshots() {
      showStatus('Screenshot generation coming soon! For now, take screenshots of your app manually.', 'success');
      markChecklistItem('check-screenshots', true);
    }

    function showProgress() {
      document.getElementById('progress').style.display = 'block';
    }

    function hideProgress() {
      document.getElementById('progress').style.display = 'none';
    }

    function updateProgress(current, total) {
      const percent = (current / total) * 100;
      document.getElementById('progressFill').style.width = percent + '%';
      document.getElementById('progressText').textContent = `Generating: ${current}/${total} icons`;
    }

    function showStatus(message, type) {
      const status = document.getElementById('status');
      status.textContent = message;
      status.className = 'status ' + type;
      
      setTimeout(() => {
        status.style.display = 'none';
      }, 5000);
    }

    function markChecklistItem(id, done) {
      const item = document.getElementById(id);
      if (done) {
        item.classList.add('done');
      } else {
        item.classList.remove('done');
      }
    }

    // Initialize with DevTrack logo
    window.addEventListener('load', () => {
      // Try to load the existing logo
      const img = new Image();
      img.onload = () => {
        uploadedImage = img;
        previewImage.src = img.src;
        preview.classList.add('active');
      };
      img.src = '/logo.svg';
    });
  </script>
</body>
</html>
